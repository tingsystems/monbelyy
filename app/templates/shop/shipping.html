<div class="content-area">
    <div class="container">
        <div class="row">
            <div class="col-md-6 address-form">

                <div class="col-md-12">
                    <h4><i class="fa fa-truck"></i> Selecciona la forma de envio</h4>
                    <hr>
                    <md-radio-group ng-model="Payment.sendOptions" ng-change="Payment.changeShippingOptions()">
                        <md-radio-button value="0" class="md-primary">
                            <span class="fa fa-truck">
                                    Envío a domicilio
                                </span>
                        </md-radio-button>

                        <md-radio-button value="1"> <span class="fa fa-building">
                                    Recoger en tienda
                                </span></md-radio-button>
                    </md-radio-group>
                    <br>
                </div>
                <div class="col-md-12" ng-if="Payment.sendOptions === '0'">
                    <h4><i class="fa fa-map-marker"></i>Seleccionar dirección
                        existente </h4>
                    <hr>
                    <ng-include src="'/templates/shop/shipping-address.html'"></ng-include>
                    
                    <div ng-if="Payment.cart.metadata.shipment">
                        <h6>Detalles del envío</h6>
                        <p>Envío {{ Payment.cart.metadata.shipment.servicelevel}} por <strong>{{Payment.cart.metadata.shipment.provider}}</strong> de {{Payment.cart.metadata.shipment.duration_terms}}</p>
                    </div>

                    <button ng-if="Payment.address && Payment.sendOptions === '0'" class="btn btn-danger" type="submit"
                            ng-disabled="!Payment.address"
                            ng-click="Payment.saveShippingAddress()">Continuar
                    </button>
                    <br>

                    <p ng-if="Payment.address && Payment.sendOptions === '1'">{{Payment.address.metadata.codeGetShop ===
                        true ? 'Puedes recorger tu pedido en estas tiendas': 'Lo sentimos pero por tu ubucación no es
                        posible recoger en tienda, por favor selecciona otra forma de envio '}}</p>

                    <div class="col-xs-12 col-sm-12 col-md-12"
                         ng-if="Payment.address && Payment.sendOptions === '1' && Payment.address.metadata.codeGetShop === true">
                        <md-input-container>
                            <label for="shop">Selecciona la tienda para recoger tu pedido</label>
                            <md-select ng-model="Payment.shop" id="shop" name="shop" title="Direccion">
                                <md-option ng-repeat="shop in Payment.defaultbranchOffice.metadata.addressGetShop.array"
                                           ng-value="shop">
                                    {{ shop }}
                                </md-option>
                            </md-select>
                        </md-input-container>
                    </div>

                    <br>
                </div>
                <div class="col-md-12" ng-if="Payment.sendOptions === '1'">
                    <button class="btn btn-danger" type="submit"
                            ng-click="Payment.retriveInStore()">Continuar y recoger en tienda
                    </button>
                </div>
                <form name="Form" ng-if="Payment.sendOptions === '0'">
                    <div>
                        <div class="col-md-12">
                            <h4 title="Presiona">
                                <i class="fa" ng-class="Payment.addAddress ? 'fa-minus-circle': 'fa-plus-circle'" ng-click="Payment.showAddress()"></i> Agregar direccíon de envío
                            </h4>
                            <hr>
                            <div class="form-horizontal" ng-if="Payment.addAddress">
                                <div class="row">
                                    <div class="col-md-6">
                                        <md-input-container class="md-block">
                                            <label>Estado</label>
                                            <md-select ng-model="Payment.state" md-on-open="Payment.getStates()"
                                                       data-md-container-class="selectdemoSelectHeader"
                                                       md-on-close="searchState='';Payment.clearCities()" name="state"
                                                       required>
                                                <md-select-header class="demo-select-header">
                                                    <input ng-model="searchState" type="search"
                                                           placeholder="Busca un estado..."
                                                           class="demo-header-searchbox md-text"
                                                           ng-keydown="$event.stopPropagation()">
                                                </md-select-header>
                                                <div layout="row" layout-align="center center"
                                                     ng-if="Payment.busyState">
                                                    <md-progress-circular md-mode="indeterminate"
                                                                          class="md-warn md-default-theme"
                                                                          style="transform: scale(1);"></md-progress-circular>
                                                </div>
                                                <md-option ng-repeat="state in Payment.states | filter:searchState"
                                                           ng-value="state">
                                                    {{state.name}}
                                                </md-option>
                                            </md-select>
                                            <div class="errors" ng-messages="Payment.form.state.$error">
                                                <div ng-message="required">Requerido</div>
                                            </div>
                                        </md-input-container>
                                    </div>
                                    <div class="col-md-6">

                                        <md-input-container class="md-block">
                                            <label>Ciudad</label>
                                            <md-select ng-model="Payment.city" md-on-open="Payment.getCitiesByState()"
                                                       data-md-container-class="selectdemoSelectHeader"
                                                       md-on-close="searchCity=''"
                                                       ng-disabled="Payment.disableCity" name="city" required>
                                                <md-select-header class="demo-select-header">
                                                    <input ng-model="searchCity" type="search"
                                                           placeholder="Busca una ciudad de {{Payment.state.name}}"
                                                           class="demo-header-searchbox md-text"
                                                           ng-keydown="$event.stopPropagation()">
                                                </md-select-header>
                                                <div layout="row" layout-align="center center" ng-if="Payment.busyCity">
                                                    <md-progress-circular md-mode="indeterminate"
                                                                          class="md-warn md-default-theme"
                                                                          style="transform: scale(1);"></md-progress-circular>
                                                </div>
                                                <md-option ng-repeat="city in Payment.cities | filter:searchCity"
                                                           ng-value="city">
                                                    {{city.name}}
                                                </md-option>
                                            </md-select>
                                            <div class="errors" ng-messages="Payment.form.city.$error">
                                                <div ng-message="required">Requerido</div>
                                            </div>
                                        </md-input-container>
                                    </div>
                                </div>
                            </div>
                            <div class="container" ng-if="Payment.addAddress" >
                                <div class="row">
                                    <div class="col-md-12">
                                        <md-input-container md-no-float
                                                            ng-class="{ 'has-error': Form.address.$touched && Form.address.$invalid }">
                                            <input ng-model="Payment.formData.address" type="text" id="address"
                                                   name="address"
                                                   placeholder="Calle y número"
                                                   required>
                                            <span ng-messages="Form.address.$error" ng-if="Form.address.$touched">
                                        <a ng-message="required" data-toggle="tooltip" title="Holiis"></a></span>
                                        </md-input-container>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-sm-12">
                                        <p>Entre las calles*</p>
                                    </div>
                                    <div class="col-md-6">
                                        <md-input-container md-no-float
                                                            ng-class="{ 'has-error': Form.address.$touched && Form.address.$invalid }">
                                            <input ng-model="Payment.formData.metadata.addressBetween1" type="text" id="addressBetween1"
                                                   name="addressBetween1"
                                                   placeholder="Calle 1"
                                                   required>
                                            <span ng-messages="Form.address.$error" ng-if="Form.address.$touched">
                                        <a ng-message="required" data-toggle="tooltip" title="Holiis"></a></span>
                                        </md-input-container>
                                    </div>

                                    <div class="col-md-6">
                                        <md-input-container md-no-float
                                                            ng-class="{ 'has-error': Form.address.$touched && Form.address.$invalid }">
                                            <input ng-model="Payment.formData.metadata.addressBetween2" type="text" id="addressBetween2"
                                                   name="addressBetween2"
                                                   placeholder="Calle 2"
                                                   required>
                                            <span ng-messages="Form.address.$error" ng-if="Form.address.$touched">
                                        <a ng-message="required" data-toggle="tooltip" title="Holiis"></a></span>
                                        </md-input-container>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-xs-12 col-md-6">
                                        <md-input-container>
                                            <input ng-model="Payment.formData.neighborhood" type="text"
                                                   id="neighborhood"
                                                   name="neighborhood"
                                                   placeholder="Colonia"
                                                   required>
                                            <span ng-messages="Form.address.$error" ng-if="Form.address.$touched">
                                        <a ng-message="required" data-toggle="tooltip" title="Holiis"></a></span>
                                        </md-input-container>
                                    </div>
                                    <div class="col-xs-12 col-md-6">
                                        <md-input-container>
                                            <input ng-model="Payment.formData.zip" ng-pattern="/^[0-9]{5}$/"
                                                   maxlength="5" id="zip" name="zip"
                                                   placeholder="Código Postal"
                                                   required>
                                        </md-input-container>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-xs-12 col-md-6">
                                        <md-input-container>
                                            <input ng-model="Payment.formData.phone" type="text" maxlength="20"
                                                   id="phone"
                                                   name="phone"
                                                   placeholder="Teléfono" required>
                                        </md-input-container>
                                    </div>
                                    <div class="col-xs-12 col-md-6">
                                        <md-input-container>
                                            <input ng-model="Payment.formData.mobile" type="text" ng-maxlength="20"
                                                   id="mobile"
                                                   name="mobile"
                                                   placeholder="Celular" required>
                                        </md-input-container>
                                    </div>
                                </div>
                                <div class="col-md-12 text-right" style="margin-top: 30px;"
                                     ng-if="Payment.sendOptions === '0'">
                                    <a href="" class="btn btn-outline-dark" ui-sref="shopcart"><i
                                            class="fa fa-angle-left"></i>
                                        Regresar al carrito
                                    </a>

                                    <button ng-if="!Form.$invalid" class="btn btn-danger"
                                            type="submit"
                                            ng-disabled="Form.$invalid" ng-click="Payment.newShippingAddress()">
                                        Guardar dirección y enviar
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-12" style="margin-top: 30px;"
                         ng-if="Payment.sendOptions === '1' && Payment.addAddress">
                        <button class="btn btn-danger" type="button"
                                ng-disabled="Form.$invalid" ng-click="Payment.saveShippingAddressValidate()">Guardar
                            direccion y validar
                        </button>
                    </div>

                    <div class="col-md-12" style="margin-top: 30px;"
                         ng-if="Payment.sendOptions === '1' && Payment.addresses.length > 0 && Payment.address.metadata.codeGetShop === true">
                        <button class="btn btn-danger" type="button"
                                ng-disabled="Form.$invalid" ng-click="Payment.retriveInStore()">Continuar y recoger en
                            tienda
                        </button>
                    </div>
                </form>
            </div>
            <div class="col-md-6">
                <ng-include src="'/templates/shop/partials/cart-details.html'"></ng-include>
            </div>
        </div>
    </div>
</div>

